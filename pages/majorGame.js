import{shuffle,addText,getId,addClick,elAdd,importPage}from"../scripts/helpers.js";import images from"../data/majorData.js";let filteredImages="",popped="",filteredCopy=[],shuffledSet=[],imagesHTML="",mode=!0,wrong="",step=0;function setMajorGame(){elAdd("AppContent",'<div id="container">\n      <div id="header">\n        <div id="headerBox">\n          <div id="headerText">0</div>\n          <span id="x">X<span>\n        </div>\n      </div>\n      <div id="wrongBox" class="hide">\n        <div id="wrong">Wrong</div>\n      </div>\n      <div id="images"></div>\n      <div id="controls">\n        <button id="back">Back</button>\n        <button id="mode">Mode</button>\n        <button id="next">Next</button>\n      </div>\n    </div>'),gameInit(),addClick("x",()=>importPage("menu"))}function gameInit(){addImageSet(),selectImage(),addClick("controls",e=>changeSet(e.target.id)),addClick("images",checkMatch)}function addImageSet(){imagesHTML="",setFilteredImages(),filteredImages.forEach(({name:e,num:t})=>{imagesHTML+=`<img src='images/${e}.webp' class="stickers ${t}" alt='${e}' loading="lazy">`}),elAdd("images",imagesHTML),copyShuffle()}function changeMode(){mode?(getId("headerText").textContent=popped.name,mode=!1):(getId("headerText").textContent=popped.num,mode=!0)}function checkMatch(e){if("IMG"==e.target.tagName){e.target.classList[1]==popped.num?(e.target.classList.add("fade"),selectImage()):(toggleWrong(),wrong=setTimeout(toggleWrong,1e3))}}function changeSet(e){"back"==e&&stepDown(),"next"==e&&stepUp(),"mode"==e&&changeMode()}function stepUp(){10==++step&&(step=0),addImageSet(),selectImage()}function stepDown(){-1==--step&&(step=9),addImageSet(),selectImage()}function selectImage(){shuffledSet.length?(popped=shuffledSet.pop(),addText("headerText",mode?popped.num:popped.name)):stepUp()}function setFilteredImages(){filteredImages=images.filter(({type:e})=>e==step)}function copyShuffle(){filteredCopy=[...filteredImages],shuffledSet=shuffle(filteredCopy)}function toggleWrong(){getId("wrongBox").classList.toggle("hide"),clearTimeout(wrong)}export default setMajorGame;